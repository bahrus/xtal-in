import{AddEventListener}from"./add-event-listener.js";var passTo="pass-to",XtalBinder=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"attributeChangedCallback",value:function attributeChangedCallback(a,c,d){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"attributeChangedCallback",this).call(this,a,c,d),"pass-to"===a?(this._passTo=d,this.parsePassTo()):void 0}},{key:"connectedCallback",value:function connectedCallback(){var a=this;babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"connectedCallback",this).call(this),this._upgradeProperties(["passTo"]);this._observer=new MutationObserver(function(b){b.forEach(function(b){b.addedNodes.forEach(function(b){a.cascade(a._lastEvent,b)})})}),this._observer.observe(this.parentElement,{childList:!0,subtree:!0})}},{key:"disconnectedCallback",value:function disconnectedCallback(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"disconnectedCallback",this).call(this),this._observer&&this._observer.disconnect()}},{key:"parsePassTo",value:function parsePassTo(){var a=this;this.cssKeyMappers=[];var b=this._passTo.endsWith("}"),c=this._passTo+(b?";":""),d=c.split("};");d.forEach(function(b){var c=b.split("{"),d=c[1].split(";"),e={};d.forEach(function(a){var b=a.split(":");e[b[0]]=b[1].split(".")}),a.cssKeyMappers.push({cssSelector:c[0],propMapper:e})})}},{key:"setValue",value:function setValue(a,c){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"setValue",this).call(this,a,c),this._lastEvent=c,this.cascade(c,this.parentElement)}},{key:"cascade",value:function cascade(a,b){var c=this;this.cssKeyMappers&&this.cssKeyMappers.forEach(function(d){c.qsa(d.cssSelector,b).forEach(function(b){var c=function(){var c=d.propMapper[e],f=a;c.forEach(function(a){f&&(f=f[a])}),b[e]=f};for(var e in d.propMapper)c()})})}},{key:"passTo",get:function get(){return this._passTo||this.getAttribute("pass-to")},set:function set(a){this.setAttribute("pass-to",a)}}],[{key:"is",get:function get(){return"xtal-binder"}},{key:"observedAttributes",get:function get(){return babelHelpers.get(b.__proto__||Object.getPrototypeOf(b),"observedAttributes",this).concat(["pass-to"])}}]),b}(AddEventListener);customElements.get(XtalBinder.is)||customElements.define(XtalBinder.is,XtalBinder);