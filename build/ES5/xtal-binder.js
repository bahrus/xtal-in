import{AddEventListener}from"./add-event-listener.js";var passTo="pass-to",XtalBinder=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"attributeChangedCallback",value:function attributeChangedCallback(a,c,d){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"attributeChangedCallback",this).call(this,a,c,d),"pass-to"===a?(this._passTo=d,this.parsePassTo()):void 0}},{key:"connectedCallback",value:function connectedCallback(){var a=this;babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"connectedCallback",this).call(this),this._upgradeProperties(["passTo"]);this._observer=new MutationObserver(function(b){b.forEach(function(b){b.addedNodes.forEach(function(b){a.cascade(a._lastEvent,b)})})}),this._observer.observe(this.parentElement,{childList:!0,subtree:!0})}},{key:"disconnectedCallback",value:function disconnectedCallback(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"disconnectedCallback",this).call(this),this._observer&&this._observer.disconnect()}},{key:"parsePassTo",value:function parsePassTo(){var a=this,b=this._passTo.lastIndexOf("{");if(!(0>b)){this._cssSelector=this._passTo.substr(0,b);var c=this._passTo.substring(b+1,this._passTo.length-1),d=c.split(";");this._propMapper={},d.forEach(function(b){var c=b.split(":");a._propMapper[c[0]]=c[1].split(".")})}}},{key:"setValue",value:function setValue(a,c){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"setValue",this).call(this,a,c),this._lastEvent=c,this.cascade(c,this.parentElement)}},{key:"cascade",value:function cascade(a,b){var c=this;this._cssSelector&&this._propMapper&&this.qsa(this._cssSelector,b).forEach(function(b){var d=function(){var d=c._propMapper[e],f=a;d.forEach(function(a){f&&(f=f[a])}),b[e]=f};for(var e in c._propMapper)d()})}},{key:"passTo",get:function get(){return this._passTo||this.getAttribute("pass-to")},set:function set(a){this.setAttribute("pass-to",a)}}],[{key:"is",get:function get(){return"xtal-binder"}},{key:"observedAttributes",get:function get(){return babelHelpers.get(b.__proto__||Object.getPrototypeOf(b),"observedAttributes",this).concat(["pass-to"])}}]),b}(AddEventListener);customElements.get(XtalBinder.is)||customElements.define(XtalBinder.is,XtalBinder);