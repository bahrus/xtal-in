(function(){function a(a,b,c){var d;return function(){var e=this,f=arguments,g=c&&!d;clearTimeout(d),d=setTimeout(function(){d=null,c||a.apply(e,f)},b),g&&a.apply(e,f)}}function b(a,b){let c=a;const d=document.head.querySelector(`[data-was="${a}"][data-package="npm.xtal-in"]`);if(d){const a=d.dataset.is;a&&(c=a)}customElements.get(c)||customElements.define(c,b)}function c(a,c){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{b(a,c)}):b(a,c)}const d="xtal-in-detail",e="bubbles",f="composed",g="dispatch",h="detail",i="event-name",j="debounce-duration",k="zoom-in",l="zoom-out";class m extends HTMLElement{constructor(){super(...arguments),this._debounceDuration=0}get bubbles(){return this._bubbles}set bubbles(a){a?this.setAttribute(e,""):this.removeAttribute(e)}get composed(){return this._composed}set composed(a){a?this.setAttribute(f,""):this.removeAttribute(f)}get dispatch(){return this._dispatch}set dispatch(a){a?this.setAttribute(g,""):this.removeAttribute(g)}get detail(){return this._detail}set detail(a){this._detail=a,this._zoomedDetail=this.zoom(this._detail),this.onPropsChange()}get debounceDuration(){return this._debounceDuration}set debounceDuration(a){this.setAttribute(j,a.toString())}get eventName(){return this.getAttribute(i)}set eventName(a){this.setAttribute(i,a)}get zoomIn(){return this.getAttribute(k)}set zoomIn(a){this.setAttribute(k,a)}get zoomOut(){return this.getAttribute(l)}set zoomOut(a){this.setAttribute(l,a)}zoomInObject(a){if(!this.zoomIn)return a;let b=a;const c=this.zoomIn.split(".");for(let d=0,e=c.length;d<e;d++){const a=c[d];if(b=b[a],!b)return null}return b}zoomOutObject(a){if(!this.zoomOut)return a;let b=a;return this.zoomOut.split(".").forEach(()=>{b={token:b}}),b}zoom(a){return null===a?a:this.zoomInObject(this.zoomOutObject(a))}get value(){return this._value}setValue(a){this._value=a;const b=new CustomEvent("value-changed",{detail:{value:a},bubbles:!0,composed:!1});this.dispatchEvent(b)}onPropsChange(){this._dispatch&&this._detail&&this.eventName&&(this._debounceFunction?this._debounceFunction():this.emitEvent())}emitEvent(){const a=new CustomEvent(this.eventName,{detail:this._zoomedDetail,bubbles:this.bubbles,composed:this.composed});this.dispatchEvent(a),this._isSubClass||this.setValue(a.detail)}static get observedAttributes(){return[e,f,g,h,i,j,k,l]}_upgradeProperties(a){a.forEach(a=>{if(this.hasOwnProperty(a)){let b=this[a];delete this[a],this[a]=b}})}snakeToCamel(a){return a.replace(/(\-\w)/g,function(a){return a[1].toUpperCase()})}connectedCallback(){this._upgradeProperties(m.observedAttributes.map(a=>this.snakeToCamel(a)))}attributeChangedCallback(b,c,d){b===e||b===g||b===f?this["_"+this.snakeToCamel(b)]=null!==d:b===h?this._detail=this.zoom(JSON.parse(d)):b===j?(this._debounceDuration=parseFloat(d),0<this._debounceDuration&&(this._debounceFunction=a(()=>{this.emitEvent()},this._debounceDuration))):void 0;this.onPropsChange()}}if(!customElements.get(d)){c("custom-event",m);customElements.define(d,class extends m{})}const n="filter";class o extends m{get filter(){return this._filter}set filter(a){this.setAttribute(n,JSON.stringify(a))}static get observedAttributes(){return super.observedAttributes.concat([n])}attributeChangedCallback(a,b,c){super.attributeChangedCallback(a,b,c);a===n?this._filter=JSON.parse(c):void 0}getValues(a){const b={};return a.forEach(a=>{b[a]=this._child[a]}),b}addMutationObserver(){if(this.disconnect(),!!this._child){const a={attributes:!0,attributeFilter:this._filter};this._observer=new MutationObserver(a=>{a.forEach(a=>{this.detail={mutation:a}});const b=this.filter?this.getValues(this.filter):this._child.attributes;this.setValue(b)}),this._observer.observe(this._child,a)}}getChild(){switch(this.childElementCount){case 0:return void setTimeout(()=>{this.getChild()},100);case 1:this._child=this.firstElementChild,this.addMutationObserver();break;default:console.error("This component only supports a single element child");}}disconnect(){this._observer&&this._observer.disconnect()}connectedCallback(){super.connectedCallback(),this._upgradeProperties([n]),this.getChild()}}c("observe-attributes",o);customElements.define("xtal-in-attributes",class extends o{});const p="watch-subtree";class q extends m{constructor(){super(),this._mutationCount=0,this._isSubClass=!0}static get observedAttributes(){return super.observedAttributes.concat([p])}get watchSubtree(){return this._watchSubtree}set watchSubtree(a){a?this.setAttribute(p,""):this.removeAttribute(p)}attributeChangedCallback(a,b,c){super.attributeChangedCallback(a,b,c);a===p?(this._watchSubtree=null!==c,this.disconnect(),this.addMutationObserver()):void 0}disconnect(){this._observer&&this._observer.disconnect()}addMutationObserver(){var a={childList:!0,subtree:this._watchSubtree};this._observer=new MutationObserver(a=>{a.forEach(a=>{this.detail={mutation:a}}),this._mutationCount++,this.setValue(this._mutationCount)}),this.detail={status:"observing"},this.setValue(this._mutationCount),this._observer.observe(this,a)}connectedCallback(){super.connectedCallback(),this.addMutationObserver()}disconnedCallback(){this.disconnect()}}c("observe-children",q);customElements.define("xtal-in-children",class extends q{});const r="on",s="if-matches",t="value-props",u="cascade-down",v="xtal-in-curry";class w extends m{constructor(){super(),this._isSubClass=!0}get stopPropagation(){return this._stopPropagation}set stopPropagation(a){a?this.setAttribute("stop-propagation",""):this.removeAttribute("stop-propagation")}get on(){return this._on}set on(a){this.setAttribute(r,a)}get ifMatches(){return this._ifMatches}set ifMatches(a){this.setAttribute(s,a)}get valueProps(){return this._valueProps}set valueProps(a){this.setAttribute(t,a.toString())}get cascadeDown(){return this.getAttribute(u)}set cascadeDown(a){this.setAttribute(u,a)}static get observedAttributes(){return super.observedAttributes.concat(["stop-propagation",r,s,t,u])}attributeChangedCallback(a,b,c){switch(super.attributeChangedCallback(a,b,c),a){case"stop-propagation":this._stopPropagation=null!==c;break;case t:this._valueProps=null===c?null:c.startsWith("[")?JSON.parse(c):c;case s:this._ifMatches=c;break;case u:this.propagateDown();break;case r:this._on=c;const d=this.parentElement;let e=d[v];if(this._on){e||(e=d[v]={});let a=e[this._on];a||(a=e[this._on]=[],this.parentElement.addEventListener(this._on,this.handleEvent)),a.push(this)}else this.disconnect();}}modifyEvent(a,b){b.stopPropagation&&a.stopPropagation()}propagateDown(){if(!this.eventName)return;const a=this.eventName+"-props",b=this.parentElement.querySelectorAll("["+a+"]");for(let c=0,d=b.length;c<d;c++){const d=b[c],e=d.getAttribute(a).split(",");e.forEach(a=>{d[a]=this.value})}}handleEvent(a){const b=this["xtal-in-curry"][a.type];b.forEach(b=>{const c=a.target;if(!b._ifMatches||c.matches(b._ifMatches)){if(b.modifyEvent(a,b),this._valueProps){let a,d=!1;Array.isArray(this._valueProps)?(d=!0,a={},this._valueProps.forEach(b=>{a[b]=c[b]})):a=c[this._valueProps];const e={};b._zoomedDetail&&(e.context=b._zoomedDetail),a&&(d?e.values=a:e.value=a),b.detail=e}else b.detail=b._zoomedDetail;const d=Object.assign({},b.detail);b.setValue(d),b.cascadeDown&&b.propagateDown()}})}removeElement(a,b){const c=a.indexOf(b);-1!==c&&a.splice(c,1)}disconnect(){const a=this.parentElement;let b=a[v];const c=b[this._on];this.removeElement(c,this),0===c.length&&this.parentElement.removeEventListener(this._on,this.handleEvent)}connectedCallback(){super.connectedCallback(),this._upgradeProperties(["on","stopPropagation","valueProps"])}disconnectedCallback(){this.disconnect()}}if(!customElements.get(v)){c("add-event-listener",w);customElements.define(v,class extends w{})}})();