import{AddEventListener}from"./add-event-listener.js";const passTo="pass-to";class XtalBinder extends AddEventListener{static get is(){return"xtal-binder"}get passTo(){return this._passTo||this.getAttribute("pass-to")}set passTo(a){this.setAttribute("pass-to",a)}static get observedAttributes(){return super.observedAttributes.concat(["pass-to"])}attributeChangedCallback(a,b,c){super.attributeChangedCallback(a,b,c);"pass-to"===a?(this._passTo=c,this.parsePassTo()):void 0}connectedCallback(){super.connectedCallback(),this._upgradeProperties(["passTo"]);this._observer=new MutationObserver(a=>{a.forEach(a=>{a.addedNodes.forEach(a=>{this.cascade(this._lastEvent,a)})})}),this._observer.observe(this.parentElement,{childList:!0,subtree:!0})}disconnectedCallback(){super.disconnectedCallback(),this._observer&&this._observer.disconnect()}parsePassTo(){this.cssKeyMappers=[];const a=this._passTo.endsWith("}"),b=this._passTo+(a?";":""),c=b.split("};");c.forEach(a=>{const b=a.split("{"),c=b[1].split(";"),d={};c.forEach(a=>{const b=a.split(":");d[b[0]]=b[1].split(".")}),this.cssKeyMappers.push({cssSelector:b[0],propMapper:d})})}setValue(a,b){super.setValue(a,b),this._lastEvent=b,this.cascade(b,this.parentElement)}cascade(a,b){this.cssKeyMappers&&this.cssKeyMappers.forEach(c=>{this.qsa(c.cssSelector,b).forEach(b=>{for(var d in c.propMapper){const e=c.propMapper[d];let f=a;e.forEach(a=>{f&&(f=f[a])}),b[d]=f}})})}}customElements.get(XtalBinder.is)||customElements.define(XtalBinder.is,XtalBinder);