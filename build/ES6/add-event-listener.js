import{XtalCustomEvent,registerTagName}from'./custom-event.js';const stopPropagation='stop-propagation',on='on',ifMatches='if-matches',valueProps='value-props',defaultTagName1='add-event-listener',canonicalTagName2='xtal-in-curry';class AddEventListener extends XtalCustomEvent{constructor(){super(),this._isSubClass=!0}get stopPropagation(){return this._stopPropagation}set stopPropagation(a){a?this.setAttribute(stopPropagation,''):this.removeAttribute(stopPropagation)}get on(){return this._on}set on(a){this.setAttribute(on,a)}get ifMatches(){return this._ifMatches}set ifMatches(a){this.setAttribute(ifMatches,a)}get valueProps(){return this._valueProps}set valueProps(a){this.setAttribute(valueProps,a.toString())}static get observedAttributes(){return super.observedAttributes.concat([stopPropagation,on,ifMatches,valueProps])}attributeChangedCallback(a,b,c){switch(super.attributeChangedCallback(a,b,c),a){case stopPropagation:this._stopPropagation=null!==c;break;case valueProps:this._valueProps=null===c?null:c.startsWith('[')?JSON.parse(c):c;case ifMatches:this._ifMatches=c;break;case on:this._on=c;const d=this.parentElement;let e=d[canonicalTagName2];if(this._on){e||(e=d[canonicalTagName2]={});let a=e[this._on];a||(a=e[this._on]=[],this.parentElement.addEventListener(this._on,this.handleEvent)),a.push(this)}else this.disconnect();}}handleEvent(a){const b=this['xtal-in-curry'][a.type];b.forEach((b)=>{const c=a.target;if(b._ifMatches&&!c.matches(b._ifMatches))return;b.stopPropagation&&a.stopPropagation();const d={context:b.detail};let e;this._valueProps&&(Array.isArray(this._valueProps)?(e={},this._valueProps.forEach((a)=>{e[a]=c[a]})):e=c[this._valueProps],d.values=e),b.detail=d,b.setValue(e)})}removeElement(a,b){const c=a.indexOf(b);-1!==c&&a.splice(c,1)}disconnect(){const a=this.parentElement;let b=a[canonicalTagName2];const c=b[this._on];this.removeElement(c,this),0===c.length&&this.parentElement.removeEventListener(this._on,this.handleEvent)}connectedCallback(){super.connectedCallback(),this._upgradeProperties(['on','stopPropagation','valueProps'])}disconnectedCallback(){this.disconnect()}}registerTagName(defaultTagName1,AddEventListener);class XtalInCurry extends AddEventListener{}customElements.define(canonicalTagName2,XtalInCurry);